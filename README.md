# 明日方舟自动化脚本

众所周知明日方舟是个休闲游戏，然而每天看录像也很烦人，因此就用蚂蚁森林脚本的一些组件又写了这个脚本。
这个脚本中提供的开发模板和函数功能可以很方便的应用到各种需要找图的脚本。

目前由于时间原因，很多功能还未添加，不过已经能够满足日常使用。当前仅支持16:9的设备，2K和1080P分辨率下
已测试可以完美运行，720P找图会失败。对于目前主流的全面屏设备，大部分的像素密度其实都是1080P的，只是
屏幕高度不同罢了，因此图片的问题不大，但是类似坐标和找图区域，不同分辨率没法直接适配，可以自行添加到
`REGIONS_MAIN.js`文件里面。如果默认的图片识图失败，需要自己添加图片，则需要用 PhotoShop 等软件
把需要替换的图片截取好后丢到`/tool/tmp`下面，然后运行`getBinarizedImage.js`获取图片的BASE64，之后
去`IMAGES_MAIN.js`手动替换，注意修改你图片对应的基准设备分辨率。

# 脚本目录结构

```
 ├── /asset                       // 资源目录
 │   ├── IMAGES_MAIN.js           // 脚本运行所需的图片，以二值化后的BASE64保存
 │   ├── IMAGES_MATERIAL.js       // 结算时材料统计所需图片，以二值化后的BASE64保存
 │   ├── OBJECTS_MATERIAL.js      // 需要的材料的相关信息
 │   └── REGIONS_MAIN.js          // 脚本中需要用到的位置信息
 ├── /lib
 │   ├── Automator.js             // 自动化工厂方法
 │   ├── CommonFuncs.js           // 公用函数
 │   ├── Inspector.js             // 服务检测
 │   └── Unlock.js                // 解锁模块（来自SuperMonster003）
 ├── /tool
 │   ├── getBinarizedImage.js     // 将 /tmp 目录中的图片二值化后输出BASE64
 │   └── /tmp                     // 需要转为BASE64的图片目录
 ├── config_main.js               // 主要预设文件
 ├── config_unlock.js             // 解锁预设文件（来自SuperMonster003）
 ├── launch.js                    // 入口程序
 └── project.json                 // 项目信息
```

# 功能简介

* 通过ADB自动开启无障碍服务
* 可以定时启动自动解锁并运行
* 根据预设的目标材料和目标数量自动循环运行
* 根据预设使用药水或者源石补充理智
* 识别并统计关卡结算的奖励
* 保存每个主线章节上次进入的关卡以便左右滑动寻找
* 利用 `BaiduOCR` 识别数字，用来统计龙门币的数量
* 利用 `OpenCV` 检测结算界面的材料，用来统计材料获取

# 未完成的功能

* 匹配不同分辨率的设备
* 提供一个修改预设的 UI 界面
* 运行主程序弹出一个对话框，询问是否变更预设，5s后直接运行
* 将要刷取的材料组合成任务队列，顺序执行
* 提供一个工具，可以添加新的关卡信息，包括图片选择和截取的功能